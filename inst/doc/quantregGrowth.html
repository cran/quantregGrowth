<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Vito M.R. Muggeo" />

<meta name="date" content="2023-03-24" />

<title>quantregGrowth: nonparametric quantile regression for growth charts and additive models</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">quantregGrowth: nonparametric quantile
regression for growth charts and additive models</h1>
<h4 class="author">Vito M.R. Muggeo</h4>
<h4 class="date">2023-03-24</h4>



<style>
body {
text-align: justify}
</style>
<p>The package <code>quantregGrowth</code> aims to estimate the smooth,
but unspecified, effect of numerical covariate(s) on one or more
quantiles of the numerical response variable. The quantile regression
equation can also include linear effect(s) of numerical or categorical
covariates. Each flexible and unspecified relationship is expressed via
a B-spline basis whose coefficients are somehow shrunken to control the
wiggliness of the curve(s). The amount of smoothness is estimated as
part of the model fitting as described in <a href="https://journals.sagepub.com/doi/full/10.1177/1471082X20929802">Muggeo
et al., 2021</a>.</p>
<p>The package relies on the well known <code>quantreg</code> package by
Roger Koenker by exploiting full functionality and efficiency of its
fitter functions.</p>
<div id="growth-charts-for-the-eager--" class="section level2">
<h2>Growth charts (for the eager :-))</h2>
<p>When focus is on multiple response quantiles (1%, 5%,…, 95%, say)
depending on a single variable, the resulting fitted quantile curves are
also referred as growth charts. Growth charts are smooth quantile
trajectories at different probability values, ‘tau’, with the
noncrossing property, namely the quantile curve at any specified tau
value has to be always higher then the quantile curve at any lower
probability value. Growth charts are used to build reference values of
an outcome of interest with respect to another variable, usually age or
time. Typical examples include height (or weight) or vocabulary size
development versus the children’s age as investigated in <a href="http://wordbank.stanford.edu/">wordbank website</a>.</p>
<p><code>quantregGrowth</code> uses B-splines with a penalty on the
coefficients and relevant smoothing parameter `selected’ within the
estimation algorithm, and imposes proper constraints to prevent quantile
crossing.</p>
<p>We build growth charts of height versus age using the data set
<code>SiChildren</code> shipped with the package. The main function is
<code>gcrq()</code> which requires the usual model formula including the
<code>ps()</code> function on the right hand side. <code>gcrq()</code>
returns quantile curves at (default) probability values
<code>c(.1, .25, .5, .75, .9)</code>, but in this example we choose
different values via the argument <code>tau</code>, and display the
result by means of the <code>plot</code> method function:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantregGrowth)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(SiChildren)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>o <span class="ot">&lt;-</span><span class="fu">gcrq</span>(height <span class="sc">~</span> <span class="fu">ps</span>(age), <span class="at">tau=</span><span class="fu">seq</span>(.<span class="dv">05</span>,.<span class="dv">95</span>,<span class="at">l=</span><span class="dv">7</span>), <span class="at">data=</span>SiChildren)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(o, <span class="at">res=</span><span class="cn">TRUE</span>) <span class="co">#res=TRUE displays data too</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<p>In addition to the graphical output, we could look at the estimated
quantile values via the function <code>charts()</code> which is a simple
wrapper of <code>predict.gcrq()</code> to facilitate production of
growth charts based on the fitted model. We display the quantiles just
at some age values</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">charts</span>(o, <span class="at">k=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="fl">10.5</span>,<span class="dv">11</span>,<span class="dv">16</span>,<span class="dv">17</span>)) <span class="co">#the quantile at the specified k values</span></span></code></pre></div>
<pre><code>&gt;            0.05    0.2   0.35    0.5   0.65    0.8   0.95
&gt; age 10   135.24 138.35 141.05 143.00 144.23 146.29 149.83
&gt; age 10.5 133.02 136.86 140.29 142.25 144.00 146.85 151.83
&gt; age 11   133.41 137.75 141.17 143.14 145.24 148.52 154.43
&gt; age 16   154.36 160.47 164.16 168.39 170.16 172.18 176.94
&gt; age 17   159.20 163.33 165.38 171.00 171.64 172.47 175.38</code></pre>
<p>Results look reasonable, but there are some annoying features which
need to be stressed: at around age=16 the highest quantile curve (the
95th) decreases, while some quantile curves (the 5th to the 65th) drop
at early ages around 11 years and then increase again afterwards.</p>
<!--

|       |   0.05|    0.2|   0.35|    0.5|   0.65|    0.8|   0.95|
|:------|------:|------:|------:|------:|------:|------:|------:|
|age 19 | 152.87| 159.38| 163.41| 167.34| 169.53| 171.98| 177.00|
|age 20 | 155.95| 161.52| 164.76| 169.38| 170.72| 172.30| 176.64|
|age 21 | 159.20| 163.33| 165.38| 171.00| 171.64| 172.47| 175.38|
-->
<p>Broadly speaking, non monotonic growth charts could be biologically
sound (for instance when modelling the body mass index), but in this
example they are not. Likely, the sparseness of data on the left and
right tails of age distribution, causes the drops in the fitted curves.
Hence we re-fit the model by imposing positive monotonicity contraints
via the argument <code>monotone=1</code> in <code>ps()</code>,</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>oM<span class="ot">&lt;-</span><span class="fu">gcrq</span>(height <span class="sc">~</span> <span class="fu">ps</span>(age, <span class="at">monotone=</span><span class="dv">1</span>), <span class="at">data=</span>SiChildren, <span class="at">tau=</span><span class="fu">seq</span>(.<span class="dv">05</span>,.<span class="dv">95</span>,<span class="at">l=</span><span class="dv">7</span>))</span></code></pre></div>
<p>In the following, we report two plots: the first one focuses on the
early ages by stressing differences between the fitted curves, and the
second figure could be possibly closer to the usual growth charts, with
legend (set at the age value <code>overlap=15</code>), underlying grid
(with 15 vertical and 10 horizontal lines) and `customized’ axis
labels.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#the 1st plot..</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(o, <span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">10.2</span>,<span class="fl">12.5</span>), <span class="at">col=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(oM, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#the 2nd..</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(oM, <span class="at">legend=</span><span class="cn">TRUE</span>, <span class="at">overlap=</span><span class="dv">15</span>, <span class="at">grid=</span><span class="fu">list</span>(<span class="at">x=</span><span class="dv">15</span>,<span class="at">y=</span><span class="dv">10</span>), <span class="at">col=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">1</span>, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Height (cm)&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Age (years)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<p>Several options are available when plotting a <code>gcrq</code>
object, see <code>?plot.gcrq</code>.</p>
</div>
<div id="additive-model" class="section level2">
<h2>Additive model</h2>
<p><code>quantregGrowth</code> can deal with multiple smooth terms
straightforwardly. We use data simulated via <code>mgcv::gamSim</code>
function (example 1). We are interested in modelling nonparametrically
the effect of four covariates on the median, say. At this aim, we call
<code>gcrq()</code> with several <code>ps()</code> terms and a single
<code>tau</code> value,</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1515</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span>mgcv<span class="sc">::</span><span class="fu">gamSim</span>(<span class="at">n=</span><span class="dv">200</span>, <span class="at">eg=</span><span class="dv">1</span>, <span class="at">verbose=</span><span class="cn">FALSE</span>) <span class="co">#verbose=FALSE just suppresses the message..</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>o <span class="ot">&lt;-</span> <span class="fu">gcrq</span>(y <span class="sc">~</span> <span class="fu">ps</span>(x0) <span class="sc">+</span> <span class="fu">ps</span>(x1) <span class="sc">+</span> <span class="fu">ps</span>(x2) <span class="sc">+</span> <span class="fu">ps</span>(x3), <span class="at">data=</span>d, <span class="at">tau=</span>.<span class="dv">5</span>)</span></code></pre></div>
<p>The plots including the fitted relationships for all 4 terms are
ready obtained by</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the fit</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(o, <span class="at">res=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">conf.level=</span>.<span class="dv">95</span>, <span class="at">shade=</span><span class="cn">TRUE</span>, <span class="at">cex.p=</span>.<span class="dv">6</span>) <span class="co">#cex.p&lt;1 to reduce the points..</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" />
where the y-label on each plot displays the edf of each smooth term.
Note, when there are multiple covariates, <code>res=TRUE</code> portrays
the partial residuals (and not the observed values).</p>
</div>
<div id="additive-model-with-linear-terms" class="section level2">
<h2>Additive model with linear terms</h2>
<p><code>gcrq()</code> can also include standard linear terms: for
instance, the above plots suggest that a simple linear term would
suffice to capture the relationships for <code>x1</code> and
<code>x3</code>. Therefore in the next model formula we include these
variables outside the <code>ps()</code> function. We also display the
model output via <code>summary.gcrq()</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>o1<span class="ot">&lt;-</span><span class="fu">gcrq</span>(y <span class="sc">~</span> <span class="fu">ps</span>(x0) <span class="sc">+</span> x1 <span class="sc">+</span> <span class="fu">ps</span>(x2) <span class="sc">+</span> x3, <span class="at">data=</span>d, <span class="at">tau=</span>.<span class="dv">5</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#the summary method</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(o1)</span></code></pre></div>
<pre><code>&gt; Call:
&gt; gcrq(formula = y ~ ps(x0) + x1 + ps(x2) + x3, tau = 0.5, data = d)
&gt; 
&gt; --------  Percentile: 0.50   check function:  157.69 -----
&gt; 
&gt; parametric terms:
&gt;                Est  StErr  |z| p-value    
&gt; (Intercept) 3.9769 0.6510 6.11   1e-09 ***
&gt; x1          6.7935 0.8178 8.31  &lt;2e-16 ***
&gt; x3          0.6163 0.8100 0.76   0.447    
&gt; ---
&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
&gt; 
&gt; smooth terms:
&gt;          edf
&gt; ps(x0) 2.000
&gt; ps(x2) 4.999
&gt; =========================
&gt; 
&gt; No. of obs = 200    No. of params = 25 (25 for each quantile) 
&gt; Overall check = 157.69  SIC = -0.105 on edf = 10 (ncross constr: FALSE)</code></pre>
<p>For the parametric terms, the summary method returns point estimates,
standard errors based on the sandwich formula, and <span class="math inline">\(p\)</span>-values coming from the Wald statistic.
Degrees of freedom for the smooth terms are printed next, along with
some useful information of the fit.</p>
<p>Of course we could estimate the same ‘semiparametric’ model at
several probability values</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>o2<span class="ot">&lt;-</span><span class="fu">gcrq</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x3 <span class="sc">+</span> <span class="fu">ps</span>(x0) <span class="sc">+</span> <span class="fu">ps</span>(x2), <span class="at">data=</span>d, <span class="at">tau=</span><span class="fu">c</span>(.<span class="dv">12</span>,.<span class="dv">25</span>,.<span class="dv">5</span>,.<span class="dv">7</span>,.<span class="dv">8</span>,.<span class="dv">9</span>))</span></code></pre></div>
<p>with the noncrossing constraints. Summary and plots can be obtained
straightforwardly.</p>
</div>
<div id="simple-linear-models" class="section level2">
<h2>Simple linear models</h2>
<p><code>gcrq()</code> can fit purely linear models, i.e. with no
<code>ps()</code> term in the formula. Here a simple example.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span>n<span class="sc">/</span>n</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span>x<span class="sc">+</span><span class="fu">rnorm</span>(n)<span class="sc">*</span><span class="fu">rev</span>(x)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>o3 <span class="ot">&lt;-</span><span class="fu">gcrq</span>(y <span class="sc">~</span> x, <span class="at">tau=</span><span class="fu">seq</span>(.<span class="dv">05</span>,.<span class="dv">95</span>,<span class="at">l=</span><span class="dv">10</span>)) <span class="co">#fit 10 (noncrossing) regression quantiles</span></span></code></pre></div>
<p>By means of <code>plot.gcrq()</code> with proper arguments, we
display in the first plot the linear growth charts, and in the 2nd and
3rd figure, we portray the tau-varying coefficients by setting
<code>axis.tau=TRUE</code>,</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(o3, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(o3, <span class="at">term=</span><span class="dv">1</span>, <span class="at">axis.tau=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(o3, <span class="at">term=</span><span class="st">&quot;x&quot;</span>, <span class="at">axis.tau=</span><span class="cn">TRUE</span>, <span class="at">conf.level =</span> .<span class="dv">95</span>, <span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<p>The 2nd and 3rd plots could be useful to assess if and how the
specified coefficient estimate changes across the quantile curves.</p>
</div>
<div id="customizing-the-penalty" class="section level2">
<h2>Customizing the penalty</h2>
<p>A possibly useful feature of <code>quantregGrowth</code> is supplying
a user-defined (multiplicative) penalty via the argument
<code>pen.matrix</code> in <code>ps()</code>. The penalty matrix <span class="math inline">\(A\)</span>, say, should be a matrix such that
<span class="math inline">\(\lambda||A\beta||_1\)</span> is the
penalization in the objective to be minimized. <span class="math inline">\(\beta\)</span> is the vector of spline
coefficients and <span class="math inline">\(\lambda\)</span> is the
smoothing parameter fixed or to be estimated. The example below
illustrates how a proper penalty matrix can be set to force a zero slope
in the fitted curve at large values of the covariate. At this aim we
consider weighted first-order differences by assigning a very large
weight to the rightmost differences to fulfill the zero slope
constraint. Overall, the penalty is <span class="math inline">\(\sum_j^{J-1} |\beta_j-\beta_{j-1}|w_j=||diag(w)
D^{(1)}\beta||_1= ||A\beta||_1\)</span>, where <span class="math inline">\(D^{(1)}\)</span> is the first-order differences
matrix and <span class="math inline">\(w\)</span> is the weight vector
as defined below. To build the customized penalty matrix with
appropriate dimension, it is probably helpful to set explicitly the
number of the basis coefficients via the arguments <code>ndx</code>
(number of covariate intervals which defaults to <span class="math inline">\(min(n/4,12)\)</span>) and <code>deg</code> (spline
degree which defaults to 3): Each basis has <code>ndx+deg-1</code>
identifiable coefficients.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(growthData)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>D1 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">diag</span>(<span class="dv">23</span>),<span class="at">dif=</span><span class="dv">1</span>)[,<span class="sc">-</span><span class="dv">1</span>] <span class="co">#the 1st order diff matrix</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">15</span>),<span class="fu">rep</span>(<span class="dv">1000</span>,<span class="dv">7</span>)) <span class="co">#the weight vector s.t. length(w)=nrow(D1)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">diag</span>(w) <span class="sc">%*%</span> D1 <span class="co">#the penalty matrix</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>o4 <span class="ot">&lt;-</span><span class="fu">gcrq</span>(y<span class="sc">~</span><span class="fu">ps</span>(x, <span class="at">ndx=</span><span class="dv">20</span>, <span class="at">pen.matrix=</span>A), <span class="at">data=</span>growthData, <span class="at">tau=</span>.<span class="dv">5</span>)</span></code></pre></div>
<p>The length of zero slope depends on number of large values in <span class="math inline">\(w\)</span>, in the above example
<code>rep(1000,7)</code>. Increasing (decreasing) the number of large
values would lead to increase (decrease) the zero slope interval.</p>
<p>Figure below reports results of the aforementioned constrained fit,
along with the fits obtained using unweighted first order-differences
without and with additional monotonicity constraints</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>o5 <span class="ot">&lt;-</span><span class="fu">gcrq</span>(y<span class="sc">~</span><span class="fu">ps</span>(x, <span class="at">d=</span><span class="dv">1</span>), <span class="at">data=</span>growthData, <span class="at">tau=</span>.<span class="dv">5</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>o6 <span class="ot">&lt;-</span><span class="fu">gcrq</span>(y<span class="sc">~</span><span class="fu">ps</span>(x, <span class="at">d=</span><span class="dv">1</span>, <span class="at">monotone =</span> <span class="dv">1</span>), <span class="at">data=</span>growthData, <span class="at">tau=</span>.<span class="dv">5</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(o4, <span class="at">res=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(o5, <span class="at">res=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(o6, <span class="at">res=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="dv">4</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display:block; margin: auto" style="display: block; margin: auto;" /></p>
<!--
output type provides a custom style sheet (and tweaks some options) to ensure that the resulting html is as small as possible. The `html_vignette` format:

- Never uses retina figures
- Has a smaller default figure size
- `summary`, `print`, `predict` 
-->
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ul>
<li><p>Muggeo V.M.R., Torretta F, Eilers P.H.C., Sciandra M., Attanasio
M. (2021). Multiple smoothing parameters selection in additive
regression quantiles, Statistical Modelling, 21, 428 - 448. <a href="https://journals.sagepub.com/doi/full/10.1177/1471082X20929802" class="uri">https://journals.sagepub.com/doi/full/10.1177/1471082X20929802</a></p></li>
<li><p>Muggeo V.M.R. (2021). Additive Quantile regression with automatic
smoothness selection: the R package quantregGrowth. <a href="https://www.researchgate.net/publication/350844895_Additive_Quantile_regression_with_automatic_smoothness_selection_the_R_package_quantregGrowth" class="uri">https://www.researchgate.net/publication/350844895_Additive_Quantile_regression_with_automatic_smoothness_selection_the_R_package_quantregGrowth</a></p></li>
</ul>
<hr />
<!--

#Attenzione.. al preambolo era questo..

date: "2023-03-24"
output: rmarkdown::html_vignette

#questo stava in fasiolo:
output: 
  html_document:
    toc: true

mia porposta:
output: 
  html_vignette:
    toc: true


IO ho cambiato output per il TOC.. .



## Methodological notes

You can write math expressions, e.g. 
$$
Q_Y(\tau|x,z)=\sum_j^Js_{j\tau}(x_j)+z^T\beta_\tau
$$
where $z^T\beta_\tau$ represents a linear predictor, and the term $s_{\tau}(\cdot)$ expresses the potentially nonlinear effect of covariate $X_j$ via  B-splines, i.e. $s_j(\cdot)=\sum_h^{H_j} b_{jh\tau}B_{jh}(\cdot)$ where $H_j$ is the fixed number of basis functions. The model is estimated by minimization of the penalized objective
$$
    \mathcal{L}_\lambda(b,\beta)=\sum_i \rho_\tau(y_i-B_i^Tb-z_i^T\beta) + \sum_j\lambda_j || D^d_j b_j ||_1
$$
where $B_i$ includes the basis function values for all smooth terms with corresponding coefficients $b=(b_1^T,\ldots,b^T_J)^T$ and the penalty $|| D^d_j b_j ||_1$ is the sum of absolute values of the coefficient differences (of order $d$): for instance to penalize the first-order differences ($d=1$) for the $j^{th}$ smooth term, 
$|| D^1_j b_j ||_1=\sum _h |\Delta^1 b^{(j)}_h|=\sum_h^{H_j-1}|b_{jh}-b_{j,h-1}|$. The penalty weight is tuned by the (positive) smoothing parameters $\lambda_j$s ($j=1,\ldots,J$): the larger the smoothing parameter, the smoother the fitted curve.



You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.


|                  |  mpg| cyl|  disp|  hp| drat|    wt|  qsec| vs| am| gear| carb|
|:-----------------|----:|---:|-----:|---:|----:|-----:|-----:|--:|--:|----:|----:|
|Mazda RX4         | 21.0|   6| 160.0| 110| 3.90| 2.620| 16.46|  0|  1|    4|    4|
|Mazda RX4 Wag     | 21.0|   6| 160.0| 110| 3.90| 2.875| 17.02|  0|  1|    4|    4|
|Datsun 710        | 22.8|   4| 108.0|  93| 3.85| 2.320| 18.61|  1|  1|    4|    1|
|Hornet 4 Drive    | 21.4|   6| 258.0| 110| 3.08| 3.215| 19.44|  1|  0|    3|    1|
|Hornet Sportabout | 18.7|   8| 360.0| 175| 3.15| 3.440| 17.02|  0|  0|    3|    2|
|Valiant           | 18.1|   6| 225.0| 105| 2.76| 3.460| 20.22|  1|  0|    3|    1|
|Duster 360        | 14.3|   8| 360.0| 245| 3.21| 3.570| 15.84|  0|  0|    3|    4|
|Merc 240D         | 24.4|   4| 146.7|  62| 3.69| 3.190| 20.00|  1|  0|    4|    2|
|Merc 230          | 22.8|   4| 140.8|  95| 3.92| 3.150| 22.90|  1|  0|    4|    2|
|Merc 280          | 19.2|   6| 167.6| 123| 3.92| 3.440| 18.30|  1|  0|    4|    4|

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
-->
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
