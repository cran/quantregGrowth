<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>quantregGrowth: Non-crossing additive quantile regression for smooth and semiparametric models with focus on growth charts</title>
<style type="text/css">
/**
 * Prism.s theme ported from highlight.js's xcode style
 */
pre code {
  padding: 1em;
}
.token.comment {
  color: #007400;
}
.token.punctuation {
  color: #999;
}
.token.tag,
.token.selector {
  color: #aa0d91;
}
.token.boolean,
.token.number,
.token.constant,
.token.symbol {
  color: #1c00cf;
}
.token.property,
.token.attr-name,
.token.string,
.token.char,
.token.builtin {
  color: #c41a16;
}
.token.inserted {
  background-color: #ccffd8;
}
.token.deleted {
  background-color: #ffebe9;
}
.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
  color: #9a6e3a;
}
.token.atrule,
.token.attr-value,
.token.keyword {
  color: #836c28;
}
.token.function,
.token.class-name {
  color: #DD4A68;
}
.token.regex,
.token.important,
.token.variable {
  color: #5c2699;
}
.token.important,
.token.bold {
  font-weight: bold;
}
.token.italic {
  font-style: italic;
}
</style>
<style type="text/css">
body {
  font-family: sans-serif;
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 1.5;
  box-sizing: border-box;
}
body, .footnotes, code { font-size: .9em; }
li li { font-size: .95em; }
*, *:before, *:after {
  box-sizing: inherit;
}
pre, img { max-width: 100%; }
pre, pre:hover {
  white-space: pre-wrap;
  word-break: break-all;
}
pre code {
  display: block;
  overflow-x: auto;
}
code { font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace; }
:not(pre) > code, code[class] { background-color: #F8F8F8; }
code.language-undefined, pre > code:not([class]) {
  background-color: inherit;
  border: 1px solid #eee;
}
table {
  margin: auto;
  border-top: 1px solid #666;
}
table thead th { border-bottom: 1px solid #ddd; }
th, td { padding: 5px; }
thead, tfoot, tr:nth-child(even) { background: #eee; }
blockquote {
  color: #666;
  margin: 0;
  padding-left: 1em;
  border-left: 0.5em solid #eee;
}
hr, .footnotes::before { border: 1px dashed #ddd; }
.frontmatter { text-align: center; }
#TOC .numbered li { list-style: none; }
#TOC .numbered { padding-left: 0; }
#TOC .numbered ul { padding-left: 1em; }
table, .body h2 { border-bottom: 1px solid #666; }
.body .appendix, .appendix ~ h2 { border-bottom-style: dashed; }
.footnote-ref a::before { content: "["; }
.footnote-ref a::after { content: "]"; }
.footnotes::before {
  content: "";
  display: block;
  max-width: 20em;
}

@media print {
  body {
    font-size: 12pt;
    max-width: 100%;
  }
  tr, img { page-break-inside: avoid; }
}
@media only screen and (min-width: 992px) {
  pre { white-space: pre; }
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
</head>
<body>
<div class="include-before">
</div>
<div class="frontmatter">
<div class="title"><h1>quantregGrowth: Non-crossing additive quantile regression for smooth and semiparametric models with focus on growth charts</h1></div>
<div class="author"><h2>Vito M.R. Muggeo</h2></div>
<div class="date"><h3>2024-05-20</h3></div>
</div>
<div class="body">
<style>
body {
text-align: justify}
</style>
<p>The package <code>quantregGrowth</code> aims to estimate the smooth, but unspecified, effect of numerical covariate(s) on one or more quantiles of the numerical response variable. The quantile regression equation can also include linear effect(s) of numerical or categorical covariates. Each flexible and unspecified relationship is expressed via a B-spline basis whose coefficients are somehow shrunken to control the wiggliness of the curve(s). The amount of smoothness is estimated as part of the model fitting as described in <a href="https://journals.sagepub.com/doi/full/10.1177/1471082X20929802">Muggeo et al. (2021)</a>.</p>
<p>The package relies on the well known <code>quantreg</code> package by Roger Koenker by exploiting full functionality and efficiency of its fitter functions.</p>
<h2 id="growth-charts-for-the-eager">Growth charts (for the eager :-))</h2>
<p>When focus is on multiple response quantiles (1%, 5%,…, 95%, say) depending on a single variable, the resulting fitted quantile curves are also referred as growth charts. Growth charts are smooth quantile trajectories at different probability values, ‘tau’, with the noncrossing property, namely the quantile curve at any specified tau value has to be always higher then the quantile curve at any lower probability value. Growth charts are used to build reference values of an outcome of interest with respect to another variable, usually age or time. Typical examples include height (or weight) or vocabulary size development versus the children’s age as investigated in <a href="http://wordbank.stanford.edu/">wordbank website</a>.</p>
<p><code>quantregGrowth</code> uses B-splines with a penalty on the coefficients and relevant smoothing parameter `selected’ within the estimation algorithm, and imposes proper constraints to prevent quantile crossing.</p>
<p>We build growth charts of height versus age using the data set <code>SiChildren</code> shipped with the package. The main function is <code>gcrq()</code> which requires the usual model formula including the <code>ps()</code> function on the right hand side. <code>gcrq()</code> returns quantile curves at (default) probability values <code>c(.1, .25, .5, .75, .9)</code>, but in this example we choose different values via the argument <code>tau</code>, and display the result by means of the <code>plot</code> method function:</p>
<pre><code class="language-r">library(quantregGrowth)
data(SiChildren)

o &lt;-gcrq(height ~ ps(age), tau=seq(.05,.95,l=7), data=SiChildren)

plot(o, res=TRUE, col=-1) #res=TRUE displays data too; col&lt;0 for the default palette
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk 1" style="display:block; margin: auto" />
<p class="caption">plot of chunk 1</p>
</div>
<p>In addition to the graphical output, we could look at the estimated quantile values via the function <code>charts()</code> which is a simple wrapper of <code>predict.gcrq()</code> to facilitate production of growth charts based on the fitted model. We display the quantiles just at some age values</p>
<pre><code class="language-r">charts(o, k=c(10,10.5,11,16,17)) #the quantile at the specified k values
</code></pre>
<pre><code>&gt;            0.05    0.2   0.35    0.5   0.65    0.8   0.95
&gt; age=10   135.24 138.35 141.05 143.00 144.23 146.29 149.83
&gt; age=10.5 133.02 136.86 140.29 142.25 144.00 146.85 151.83
&gt; age=11   133.41 137.75 141.17 143.14 145.24 148.52 154.43
&gt; age=16   154.36 160.47 164.16 168.39 170.16 172.18 176.94
&gt; age=17   159.20 163.33 165.38 171.00 171.64 172.47 175.38
</code></pre>
<p>Results look reasonable, but there are some annoying features which need to be stressed: at around age=16 the highest quantile curve (the 95th) decreases, while some quantile curves (the 5th to the 65th) drop at early ages around 11 years and then increase again afterwards.</p>
<!--

|       |   0.05|    0.2|   0.35|    0.5|   0.65|    0.8|   0.95|
|:------|------:|------:|------:|------:|------:|------:|------:|
|age=19 | 152.87| 159.38| 163.41| 167.34| 169.53| 171.98| 177.00|
|age=20 | 155.95| 161.52| 164.76| 169.38| 170.72| 172.30| 176.64|
|age=21 | 159.20| 163.33| 165.38| 171.00| 171.64| 172.47| 175.38|
-->
<p>Broadly speaking, non monotonic growth charts could be biologically sound (for instance when modelling the body mass index), but in this example they are not. Likely, the sparseness of data on the left and right tails of age distribution, causes the drops in the fitted curves. Hence we re-fit the model by imposing positive monotonicity contraints via the argument <code>monotone=1</code> in <code>ps()</code>,</p>
<pre><code class="language-r">oM&lt;-gcrq(height ~ ps(age, monotone=1), data=SiChildren, tau=seq(.05,.95,l=7))
</code></pre>
<p>In the following, we report two plots: the first one focuses on the early ages by stressing differences between the fitted curves, and the second figure could be possibly closer to the usual growth charts, with legend (set at the age value <code>overlap=15</code>), underlying grid (with 15 vertical and 10 horizontal lines) and `customized’ axis labels.</p>
<pre><code class="language-r">par(mfrow=c(1,2))
#the 1st plot..
plot(o, xlim=c(10.2,12.5), col=1, lty=3, lwd=2)
plot(oM, add=TRUE, col=2, lty=1, lwd=2)
#the 2nd..
plot(oM, legend=TRUE, overlap=15, grid=list(x=15,y=10), col=2, lty=1, 
     ylab=&quot;Height (cm)&quot;, xlab=&quot;Age (years)&quot;)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk 1b" style="display:block; margin: auto" />
<p class="caption">plot of chunk 1b</p>
</div>
<p>Several options are available when plotting a <code>gcrq</code> object, see <code>?plot.gcrq</code>.</p>
<p>By default <code>ps()</code> uses 11 basis functions which is appropriate for most of situations met in practice. However, if the underlying signal is strongly nonlinear, a richer basis is recommended to better capture changes in the curve. The following example presents data with a Doppler-like trend</p>
<pre><code class="language-r">n &lt;- 20000
x &lt;- 1:n/n
mu &lt;- sqrt(x*(1-x))*sin((2*pi*(1+2^((9-4*6)/5)))/(x+2^((9-4*6)/5)))
set.seed(3008) #just for riproducibility
y &lt;- mu+0.2*rnorm(n)
</code></pre>
<p>When the reader fits the model using the default values, the results appear unsatisfactory with the fitted curves missing the general trend. The practitioner can check that increasing <code>ndx</code> improves the smoothing on the left side, but two issues rise: i) the computational load increases as the number of spline coefficients (which depend on <code>ndx</code>); ii) at larger covariate values the curve is clearly undersmoothed. <code>gcrq</code> offers two solutions at the aforementioned issues. Firstly, to improve computational efficiency we could exploit sparse algebra methods via argument <code>sparse</code> as implemented by the package <code>SparseM</code>; and secondly, to get a fitted curve with different amount of smoothing across the covariate range, we can exploit <em>adaptive</em> smoothing, by means of the argument <code>ad</code> in <code>ps()</code>. Therefore the model can be fitted via</p>
<pre><code class="language-r">as &lt;-gcrq(y ~ 0+ps(x, ndx=100, ad=.8), sparse=TRUE)
par(mfrow=c(2,1))
plot(as)
plot(as, col=4, n.points=500, add=TRUE)
#the same plot but zoomed in on the left side
plot(as, xlim=c(0,.1))
plot(as, col=4, n.points=500, add=TRUE)
lines(x, mu, col=1, lwd=2)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk 1d" style="display:block; margin: auto" />
<p class="caption">plot of chunk 1d</p>
</div>
<p>Note we need to increase the number of values (by <code>n.points</code> in <code>plot.gcrq()</code>) to portray correctly the lines on the left side.</p>
<h2 id="additive-model">Additive model</h2>
<p><code>quantregGrowth</code> can deal with multiple smooth terms straightforwardly. We use data simulated via <code>mgcv::gamSim</code> function (example 1). We are interested in modelling nonparametrically the effect of four covariates on the median, say. At this aim, we call <code>gcrq()</code> with several <code>ps()</code> terms and a single <code>tau</code> value,</p>
<pre><code class="language-r">set.seed(1515)
d&lt;-mgcv::gamSim(n=200, eg=1, verbose=FALSE) #verbose=FALSE just suppresses the message..

o &lt;- gcrq(y ~ ps(x0) + ps(x1) + ps(x2) + ps(x3), data=d, tau=.5)
</code></pre>
<p>The plots including the fitted relationships for all 4 terms are ready obtained by</p>
<pre><code class="language-r"># Plot the fit
plot(o, res=TRUE, col=2, conf.level=.95, shade=TRUE, cex.p=.6, split=TRUE) #cex.p&lt;1 to reduce the points..
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk fig-margin" style="display:block; margin: auto" />
<p class="caption">plot of chunk fig-margin</p>
</div>
where the y-label on each plot displays the edf of each smooth term. Note, when there are multiple covariates, `res=TRUE` portrays the partial residuals (and not the observed values).
<h2 id="additive-model-with-linear-terms">Additive model with linear terms</h2>
<p><code>gcrq()</code> can also include standard linear terms: for instance, the above plots suggest that a simple linear term would suffice to capture the relationships for <code>x1</code> and <code>x3</code>. Therefore in the next model formula we include these variables outside the <code>ps()</code> function. We also display the model output via <code>summary.gcrq()</code>.</p>
<pre><code class="language-r">o1&lt;-gcrq(y ~ ps(x0) + x1 + ps(x2) + x3, data=d, tau=.5)

#the summary method
summary(o1)
</code></pre>
<pre><code>&gt; Call:
&gt; gcrq(formula = y ~ ps(x0) + x1 + ps(x2) + x3, tau = 0.5, data = d)
&gt; 
&gt; --------  Percentile: 0.50   check function:  157.69 -----
&gt; 
&gt; parametric terms:
&gt;                Est  StErr  |z|  p-value    
&gt; (Intercept) 4.0077 0.6471 6.19 5.88e-10 ***
&gt; x1          6.7935 0.8178 8.31  &lt; 2e-16 ***
&gt; x3          0.6163 0.8100 0.76    0.447    
&gt; ---
&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
&gt; 
&gt; smooth terms:
&gt;          edf
&gt; ps(x0) 2.000
&gt; ps(x2) 4.999
&gt; =========================
&gt; 
&gt; No. of obs = 200    No. of params = 25 (25 for each quantile) 
&gt; Overall check = 157.69  SIC = -0.105 on edf = 10 (ncross constr: FALSE)
</code></pre>
<p>For the parametric terms, the summary method returns point estimates, standard errors based on the sandwich formula, and \(p\)-values coming from the Wald statistic. Degrees of freedom for the smooth terms are printed next, along with some useful information of the fit.</p>
<p>Of course we could estimate the same ‘semiparametric’ model at several probability values</p>
<pre><code class="language-r">o2&lt;-gcrq(y ~ x1 + x3 + ps(x0) + ps(x2), data=d, tau=c(.12,.25,.5,.7,.8,.9))
</code></pre>
<p>with the non-crossing constraints. Summary and plots can be obtained straightforwardly.</p>
<h2 id="varying-coefficient-models">Varying coefficient models</h2>
<p>A particular case of ‘semiparametric’ model is given by the so-called varying coefficient (VC) model, wherein the linear effect of a (even categorical) covariate, \(x_1\) say, depends flexibly on a continuous variable \(x_2\). The relevant term in the linear predictor can be written \(\beta(x_2)x_1\), where \(\beta(\cdot)\) is the smooth expressed via B-splines. We simulate data via the <code>gamSim()</code> function again.</p>
<pre><code class="language-r">d&lt;-mgcv::gamSim(n=200, eg=3, scale=1) #simulated data with VC effect
</code></pre>
<pre><code>&gt; Continuous `by' variable example
</code></pre>
<p>and the fit is obtained by means of the argument <code>by</code> in <code>ps()</code>,</p>
<pre><code class="language-r">o &lt;- gcrq(y~ x1 + ps(x2, by=x1), data=d, tau=.5)
</code></pre>
<p>It should be noted we also specify the linear term <code>x1</code>, since <code>ps()</code> makes the basis identifiable. The fitted curve can be displayed as usual via <code>plot.gcrq()</code>.</p>
<p>When the linear covariate <code>x1</code> is categorical, e.g. the gender, fitting VC terms means to fit the smooth effect of <code>x2</code> into each category of <code>x1</code>. We illustrate that with a simulated dataset</p>
<pre><code class="language-r">n=50
x0&lt;-x1&lt;-x&lt;-1:n/n
y0&lt;-10+sin(2*pi*x) #sinusoidal relationship + intercept
y1&lt;-seq(7,11,l=n)  #linear relationship + intercept
sigma&lt;- .2
y&lt;-c(y0,y1)+rnorm(2*n)*sigma
x&lt;-c(x,x)
z&lt;-rep(0:1, each=n) #numeric variable
g &lt;-factor(z)  #factor
o&lt;-gcrq(y ~ g + ps(x, by=g), tau=.5)
</code></pre>
<p>Again, the same model could be obtained using a full B-spline in each group, i.e. <code>gcrq(y ~ 0 + ps(x, by=g, dropc=FALSE, center=FALSE), tau=.5)</code>.</p>
<p>We compare the true and fitted quantile curves in the next plots</p>
<pre><code class="language-r">par(mfrow=c(1,2))
plot(x0, y[1:50]);lines(x0,y0)
plot(o, term=1, add=TRUE, col=2, lwd=2)

plot(x1, y[51:100]);lines(x1,y1)
plot(o, term=2, add=TRUE, col=3, lwd=2, shift=coef(o)[&quot;g1&quot;,1])
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6" style="display:block; margin: auto" />
<p class="caption">plot of chunk unnamed-chunk-6</p>
</div>
To overlap the lines in the second group, we add the estimated coefficient of the corresponding category (`g1`) to the fitted quantile curve (via the argument `shift` of `plot.gcrq()`. When the variable in `by` is categorical, `gcrq()` automatically knows that category-specific curves have to be fitted. However it could be probably instructive to fit the same model using the numerical covariate `z`, namely   
<pre><code class="language-r">o1&lt;-gcrq(y ~ z + ps(x) + ps(x, by=z), tau=.5)
</code></pre>
<p>Note the plot of the VC term <code>ps(x, by=z)</code> represents the difference between the smooth relationships <code>y1-y0</code>, bar a constant depending on the intercepts.</p>
<h2 id="simple-linear-models">Simple linear models</h2>
<p><code>gcrq()</code> can fit purely linear models, i.e. with no <code>ps()</code> term in the formula. Here a simple example.</p>
<pre><code class="language-r">n=100
x&lt;-1:n/n
y&lt;-2*x+rnorm(n)*rev(x)

o3 &lt;-gcrq(y ~ x, tau=seq(.05,.95,l=10)) #fit 10 (noncrossing) regression quantiles
</code></pre>
<p>By means of <code>plot.gcrq()</code> with proper arguments, we display in the first plot the linear growth charts, and in the 2nd  figure, we portray the tau-varying coefficient by setting <code>axis.tau=TRUE</code>,</p>
<pre><code class="language-r">par(mfrow=c(1,2))
plot(x,y)
plot(o3, add=TRUE)
plot(o3, term=&quot;x&quot;, axis.tau=TRUE, conf.level = .95, col=2)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-9" style="display:block; margin: auto" />
<p class="caption">plot of chunk unnamed-chunk-9</p>
</div>
<p>The 2nd plot could be useful to assess if and how the specified coefficient estimate changes across the quantile curves.</p>
<h2 id="customizing-the-penalty">Customizing the penalty</h2>
<p>A possibly useful feature of <code>quantregGrowth</code> is supplying a user-defined (multiplicative) penalty via the argument <code>pen.matrix</code> in <code>ps()</code>. The penalty matrix \(A\), say, should be a matrix such that \(\lambda||A\beta||_1\) is the penalization in the objective to be minimized. \(\beta\) is the vector of spline coefficients and \(\lambda\) is the smoothing parameter fixed or to be estimated. The example below illustrates how a proper penalty matrix can be set to force a zero slope in the fitted curve at large values of the covariate. At this aim we consider weighted first-order differences by assigning a very large weight to the rightmost differences to fulfill the zero slope constraint. Overall, the penalty is \(\sum_j^{J-1} |\beta_j-\beta_{j-1}|w_j=||diag(w) D^{(1)}\beta||_1= ||A\beta||_1\), where \(D^{(1)}\) is the first-order differences matrix and \(w\) is the weight vector as defined below. To build the customized penalty matrix with appropriate dimension, it is probably helpful to set explicitly the number of the basis coefficients via the arguments <code>ndx</code> (number of covariate intervals which defaults to \(min(n/4,12)\)) and <code>deg</code> (spline degree which defaults to 3): Each basis has <code>ndx+deg-1</code> identifiable coefficients.</p>
<pre><code class="language-r">data(growthData)

D1 &lt;- diff(diag(23),dif=1)[,-1] #the 1st order diff matrix
w &lt;- c(rep(1,15),rep(1000,7)) #the weight vector s.t. length(w)=nrow(D1)
A &lt;- diag(w) %*% D1 #the penalty matrix

o4 &lt;-gcrq(y~ps(x, ndx=20, pen.matrix=A), data=growthData, tau=.5)
</code></pre>
<p>The length of the zero-slope curve piece depends on number of large values in \(w\), in the above example <code>rep(1000,7)</code>. Increasing (decreasing) the number of large values would lead to increase (decrease) the zero slope interval.</p>
<p>Figure below reports results of the aforementioned constrained fit, along with the fits obtained using unweighted first order-differences without and with additional monotonicity constraints</p>
<pre><code class="language-r">o5 &lt;-gcrq(y~ps(x, d=1), data=growthData, tau=.5)
o6 &lt;-gcrq(y~ps(x, d=1, monotone = 1), data=growthData, tau=.5)

par(mfrow=c(1,3))
plot(o4, res=TRUE, col=2, lwd=3, ylim=c(0,12))
plot(o5, res=TRUE, col=3, lwd=3, ylim=c(0,12))
plot(o6, res=TRUE, col=4, lwd=3, ylim=c(0,12))
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAogAAAEgCAMAAAAAMHKWAAABC1BMVEUAAAA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kJA6kLY6kNtUoNNZpdhfq99mOjpmOmZmOpBmZjpmZmZmZpBmZrZmkLZmkNtms+ZmtrZmtttmtv9vu+99xXGCynaI0HyP2ISQOjqQOmaQZjqQZmaQZpCQkGaQkJCQkLaQkNuQtraQttuQtv+Q2/+Y4IywsLC2ZgC2Zjq2Zma2ZpC2kDq2kGa2kJC2tpC2tra2ttu227a229u22/+2/9u2//+/v7/Pc4PR0dHUeYjaf4/bkDrbkGbbkJDbtmbbtpDbtrbbttvb27bb29vb2//b/9vb///hhpbm5ubqj5//tmb/tpD/25D/27b/29v//7b//9v///+aM8B+AAAACXBIWXMAAAsSAAALEgHS3X78AAAVSUlEQVR4nO2dC3vUxhWGsUPTNF1olmAaNl0SMG3jeClOTWhDTcXGhRSnxnZMWP3/X9LVZbWS5qIzo6OZM6PzPTxmrdHlvJ5PRzMjafZGymIR0A3fAbBYmdiILBJiI7JIiI3IIiE2IouE2IgsEmIjskiIjcgiITYii4TYiCwSYiOySIiNyCIhNiKLhNiILBJiI7JIiI3IIiE2IouE2IgsEmIjskiIjcgiITYii4TYiCwSYiOySIiNyCIhNiKLhNiILBJiI7JIiI3IIiE2IouE2IgsEmIjskiIjcgiITYii4TYiCwSYiOySIiNyCIhNiKLhIBGvEFb9vi0NSIuqBGt/yQ1JRg7ke2tR4UhBMJcpnvzbMTkApdsK78Vxlymiisj1hRV5qhpTFyKiK92dg/To5Ou1YgIHh1zUZCBEZ+drx6dBA0mF3NRkIERjw7TD7enIYPJxVwUZGDE1bPzdLUfMphczEVBlp0V1ciPd1WNabvomMuxtFyKiJ/e2NnZ2aV2hjW7cdvhBXh0zOVSJlyqiGsNX91qTtUe2LLJHMzlTkZcLscReyuRfvQ+3tZbzBWYEbdqnmyhV9hW4+UK1IhxZY6aRssVqhEbiqjCGhoTF3Ujgu53BlhhzAVYZr8aumBPgIRXYcwFWWa/Gr44c1gpPC7qRgQpwAoDaUxcbETCGhMXTSMaPpIZTIUxV65gjAhp8oY48MtchYIxIuAMa7CHUmHMVSgcIwIUYuaAaKxcwRqxrpgqrK4xcbERCWtMXGxEwhoTFxuRsMbE5caIg72qXchbhTGXlbwZ0WzyCvO/gq8KY658beP9h5ERAX+FpLVGEJmDuSoRbCPKGLq5Xr5srkOvLcVc9RUgXK6NqHrD0GwnVDLHVsyl2wm9jKh8w7CX/FcYc5nIuxET9RuGveS7wpjLTAZGvL51c7qz17mamZqnF+I8kPDomMtATrkUET87X/84xZ7CQpvmuzA15fDomMtELrkUER8fpOl7p7NLdZ1wunJ4dMyFJWwuRcSrN9Pp3Z87V8OUk8zBXGhykxEbq1Cd5qySXXTM5UsGRqQ5zZlK8OiYi4JMMiLFac6UMoiOuQjI+zjiUPI93jaUxsQVrhFDfMkIopFyBWvE+vBATBU2Vq5gjTjWzAFTeFxDG1E+mtTrZpG4sYcKY64eu/RgRPn4erZUshyGK9ml+wpjrhSZy1dGlIQHvatOOnMwF2CXpNqI1meYRJTaUszVLVJGxBSlCsPUmLiCMKL61CtKQq0wJddinv8XHddskv8XqhHVjZGyJNAKU3It5g9yJ8bGNZvcy50YqhE1j2RGlRE3vy4WcWXEza+zmYeMaNyQhW8gnnAOK8wF19qIxYfIuNZGLD44NKK2a68aqgLvvL3AXYW54Fp4MKILrpkPI+pOGJEh0W/QKRqZA4ur8mFcXFsfkmkjClwXT4y3aYhIWwqHa+HFiDqhcNV8SMaIgp505nn9lYBIhQmy4ar5MCqumg9JGjHJ56PozvMhZMS6rLlqPoyJa0bciOss356hpyqqfnSKXoVZcy1oG9Gaq+5DikbMzzBp9Hlyb2R4tSnpVZg1V92HEXHNyBsxVbb/2meYpplIsMJSSy7qRkytuJo+pGpE/fU3kXxqi2aF2XAtAjCiBVfTh2SNqBNo4JRohekk52r6MBquWQRGBHVXAqwwOVfTh7FwtX0YhBGtbrAEUGEgrkV4RgRwCT50YkRFYOJixRiALLMnrf8FOagwJ1wtH0bCJfjQxIjXt3771Wcfd64GC0x6u/JC2qqVPpFerqpuLsIrjDaXvREJc4kJ0cSIz86vDtP/WEzqY3GGdfZHEDMiaa72lTkOLtGHJkY8/ubh3upRAYY1zZkyfDUXcBN4dJS5Mh/Gx1UkxG4uRcSrn168nh52rmYi2YnUdWqpzr1WATw6ylyZD6PjKn3YzeWi15w0/qsXQJN8R4Gn3iUuV35hjo1r00C0zoiWq0ml+a4Om8EayTZ+KgyZa95qIKYxcK19CKwv9xlRd1ol3ayyzUlkjp5c8wdzIkZE5MpelwLWl7sB7QqoHthlQ8tXy+W7ZWvZ5aVuQc/ohuJqrfIyEaqzvfZC9GHoXLP8wuwjI2rODum5I3js1bJtPMGYbRlASDQMl7DSS2ESo3YFCkM38OhkosA1k4wgqqPDNKJs0LOMVJrfxUQnMR3Ah0NXmClXc+P6Vu3llaQ+DJlrNlP70GVG3I6ul+83SNPhsjRSsYFNC98kOvstjbjKhYtC66YfhEvqQ5Jcm4/3JpNZl0yiG6aNmGzOrFQ5sV5+2a1dAMTWBlzO2lIArrTod6ybfKUT89+kPttKsQIxrrX51p2P0mSTyb0uJxpFN4gR84kdK18JZFlRfl1NGtcAcx9utnBVYQCu3FPzPBMuNlZcVJLvViiiyJWbbzar2U/vQ+lxNNENlRFrqU4yxWNaNe+shtzae3aYOXRcdcuVs9ek1TVa7UXRh8S40qRmsInOaR1H0XENOXyj7v5vfdhLrjNH87Bid0OT+JRmlG1BiQt2sTU6gMaIvz7/x7l2FzZg8kZfo7ur3tboSMroXHF1uHC72ry5Wscm3rnAJuxfX9my99O7z58/vvPCcNNO1aITxmI6ttR03eDROeBKq0ZhZ4ck3/Ji3mo1ajfzymVyHUaor2zZWfHxzHBTsCSj012bAAez9NENzVUfowG4MFMOVOvI6N3rjWvTHsx6JqAN+tdXtmx1dvb2858lhfpNYRJGpw227ZkRrz75ZfezT2y2BEnWM4Ep6bwoF1JEd3RyNSRXvWditmXfjHi6+833H+kbHZZgl9BLMXSH8hWVj5kfnaSnh/JC7ZYAgVLaMFxH/9o/T09P5IXaLQECNQoH4MqXvZ/+83P9DmG3jJoftkmw83YRNKcrVlREd3pwevB2v3+FyUY683ae5DmF5obDcD29++hk9fUwXHmzcNJxPR6Cq1i2Ov5YUtaxqfKoxV2i8u7xO+mXxbQ3Bexes6IqujfTXW2T3oqruLBm7TxvXL9+/+KNNtHbchXNQi9cWOOItcnKinkci55Jc6x0KA043iZwZfW3aRbGxrVpFvrgypd9+PzqvvmmW62TXjVZWbK9lWxLZLyVKroBuNL8UWpoJ7m9O0O55SpuJJtFuNmFmYYyYn6rMtl+zpT3T6yeY7B4+mGgCpNxFV8+8SBCrny4xh8XUkZsfy47yjZcsufBOvYzXOYQP+cd5Qi58o6yR671stV/V3+91rd9jVsrPe4lJ5uf1V34ztnD5dENwaV6YAsg2lz2d5KRuDIjPnp893nHzUtDsM3IoezMAJ112XlWm7mi6Ncpt1RUGD7XxofRcZU+9MiV31l5c3B2hnlnpfKh7B1t+W1Jye9JrShR7E0bHTpX5cPYuDY+9MiVLfv7zlofIY7UNx82bIZTtCiEd2chDV7DzIHPVV2XI+OqrsseufJl13tpfQYf4KbKIzZv6TVjrhJ4a0MdVyezKjpkrmb7MB6uZvvQE1dhxLvpZgafUu3nBTqHA+pq9VRa55JmQ9juRSkrDJVLeJA6Vf0WFle7n+KHq1j25tZvmrfC2s8LmGbEzdKOE0de3NUeEaSMDpOrcV2OiKtxXfbHBXhewHSas80Y4rojpZ2uQjfVF6irVgkenT3X1odxcW196JcL+LyAoRHz/5OOd5XbzY5ageFgvUF01lzb63JcXNvrsl+uzbLV8YHppgrVuiod0Wn6+FJcpTTRYXE1GogRcTUaiD65sJ6+2UpxU0U1QgU9lXQn3YBPqRTSPAAbNJfmAVjXXMWDsQfp6jukcSnF49jSsVLwTjvWVkWHxaXzYchcOh+65iqWnd683f9By0JSHyo7XDhSRofDpfZh0FyaFwI8cDkxYo9pbbb70JQNWmGG6dBU3rgM06GpTLmQLs3VYeVXZgQu3d9muEtYon8/Klwu/ftRHriyZeX9c91tdA1Yoy+le+ymnywyBwJXeyavWLjyqZSAUdjJJiO+nh6cnX0/1SV7NVijL6V97Eaz+55SRNebq5iTobVQWBEWo42G4iqmcGgtFFaExWgjdRvxp+O//GC8aW7A2qC6fo4vjHaHSso/ez+u8qqctMpaa4fHVV6VaXGVRvzfkXZ8VLZpFum/X21nvS7mE1HvAo9L2JO6wiy5nrx8mSzKq3JXjYTGVUxoQ46rfAzs9RfmjxUla+/9e1lNaLMEzCeSCB8sJP4F1Y9LWXFlj7oni833TUCmVA6IK39zOf+VFldhxIOnhxbPtxXeKzNi+RqzFrAKqV/eB2cOS641wqKax2Ebcwxcs2oeB2pc5TjiH3/5QrsvWarPvCcebvvGrC4k3PaHerzNhmvzCn31e/FfFFy1MRtiXPmy1Vc3jWeXSi6Wl0vJmvqUrwWyplVVmB1XkiayscMYuGRjh0S4ikvzt6nprFlrKotpsLUp3j7/Ky9hVlzad/XkCoQrVb+rJ5dDrnzZhztnb/d/0L2f2N50HUQ1VlMLqDPJu80cVlyyd/Xi4BK/s5YQV3Fpfp5JNzIlOcO291C2XMpzBGlUSrET5SXMhqt8BjZCrtyHVLnsn0esXgjoPrC2BFK8WUvx58F9bi9PiBFy5RdmslzWRiym+5KHZNz8hZ6AhpmjW1Ijzm0mc6DPVcz1RZWrhxGXkhlO8iPDXsFprNPvQoBbYfMHXwrLYuCa3PtUWEaHq09GfCIAKOanaKzSXBVFqBW2WHwpzDoXA1c6+1SYdY4Ql60R8z6zwGVypiCOkSIbUZh1LgouyZcEUOLqYURhpSEf2NAK24itJXFwiWPZpLgwjYhw0tjtAbPCpDdVrPffbw8DG5EUV38jKmKxCtHyHEWssK0P4+JqzfglyjeXpRFrj8A2Y4G1bZVlYusMshNcI5Z7j4urPrOI7GDeueyNKD22orffDgl6InUNLCTy6OBSGzEyLuGpm3YgvrkUrO2v59MYsXU4ZSDma3WsuJ1yBV5hXVy6N5gBIsslayF2BmK6VseKei4Fa/vr+cBGdCvjzNHFZT1VO67QuRC+9RtD5hmx/vV8kmnOkL6BvkPg89DgEqbncmNED1xOfNiLS8na/Hq++mqJmBAHGY+SNjikRzJpS2m59JPCIskDV9uIBLnMOyvZ8Vq3VaCPdMDKdSvKW8MojfriReZFlFytL/OhyGXRa07S5eXlsnGIBlfXa4q4L+K0ozNTkyv7lr0YuZLZbEKdy2b4Jnm3XLYnF1VQyoR/XUAa5kgezOdRcl1MJveoc1mNIy6F7wLHuW1puw+s8ba58LxDHFwT4XkHelxWGVHSZ0bhsv3rIFXYfJDbzP65kkFuMyNz2bQRL5YDDd6AuCQrIbWlyqkd8OWZ68Lua5i7hcllkxEBc4sMJ9lpiJcRrXfUWwNyTXyOZkO5bIx4mTURxd0PMjglarDMUXwRc3xcaT52Q53LyojrTrPyNQEfwjLiPImRK51NJvS5rC7N75bVGWYwDDCcUCps7cMHSYRcaTb/F30uCyNmM9BtPns8rWpCMuJiO9YWEVc2P2wAXBa3+LIXSbdkPWMSZLNDlArLBhFj5MoGEQPgMjZi8lIczkaU1SmLUWHzP80XA16tvHElv5/MQuAyN+KroUYRy/1bbINkROu9QOSLKzfigPKWEdNhfWgljApbDDWa3UMYXLOhRrN7CMWIbp6JNRNChem+1sebUIxIz4doRsSJBlE4RkQJBVVsRPVqXm/vqdS/whZeb++phGBE2QMP3oVgxOy7A7DCwVP/Cps/GLarYqf+XPl3neEEg6j+Rsy+ywItHDyhZEScUFCFkBEp+rC/ES8vhxxCtFfvCsu+VQUpFkz1N+LmW1Voqa8Rcx+SuEfUEoIR51FyZfeZA+EyzIjubpWbHAcjI0bJlYpzIg6lvlw2T9+4kFHm7VthDgcRnXI5nOChNxdJIyap08zhzIeOuZwNImJwmRnRzfXLuB3a24hueiquuVz1mVG4jIzoqqdiepS+Feaqp+Kaa/ONuEMLg0vBerWze5genbRXI9gDywSvsFFx0Ry7SY2M+Ox89ehErDCigkc3Ki6Kd/dyGRjx6DD9cHtagMmmOaMleHTj4iLqQxMjrp6dp6v9+DIHc1FQMMM3psJ4XIqixsQVnBGh8+3BxFxDC8plaETv3UvpCBLC41LWe0DS6LkMB7T9PxowSOZgrsEUa0aUKoLMIdWYuAJrI8r/sOG3pZgrrIyouNQEnzmYK7Q24kCZg7kGUqwZUaHgM4dCY+IKrI0oV/htKbnGxEXfiICTOsgKY67OZfarDSBIMyfECmOu7mXK1Ry3OBLoQftWGHOhqBeXiREd98Hgh+tZYcyFon5c9DMiQEFmDoDGxEW+jQhRiG0piMbExUYkrDFxsREJa0xcbETCGhMXG5GwxsTFRiSsMXGxEQlrTFxsRMIaExcbkbDGxMVGJKwxcbERCWtMXGxEwhoTlyLi61s3pzt7nasRETw65qIgAyM+O1//OA15Uh+5mIuCDIx4fJCm7/fjm76NuSjIwIirN9Pp3Z87VyMieHTMRUHcWUHc0oXGxMVGJKwxcbERCWtMXGxEwhoTFxuRsMbEBTUibdn/SWhrRFxGrNqVfRQinfnM5ahQU8pG7BUAcxkVshH1Yi5HhWxEvZjLUSEbUS/mclSIZUQWayixEVkkxEZkkRAbkUVCbEQWCbERWSQENeLqePfF5qeq8OHNb5WFafrjfXXh8a56y9XTm4fymL47UUYEFnPJC51zQY14en+1f17+VBT+eLj6+kRVmF7fkoFVu/2zerfyY67/jrsnqSoisJhLXuicC2rEp4fp0Un5U1GYph/+IDlGUbjafy0DKwqPHu/KTqKi8PrO8Z6kMF2dZ8dURAQWc8kLnXNBjZgdfvNPUZiuvpKFVxSeHl7JwIrCv92Xnpvllntv78hzQ3ZMRURgMZciOtdc4Evz4erRSflTUfjhtvTqnxeujqe3PpJl83xLxWlSFBYntkzZNoqIwGIuaaF7LqgR399+uHe1l/1UFj69OZWdCkVhmkrPsKLw+vajjzWFj2WFaQamjAgs5pIXOufi4RsWCbERWSTERmSREBuRRUJsRBYJsRFZJMRGZJEQG5FFQmxEFgmxEVkkxEZkkRAbkUVCbEQWCbERWSTkw4i/ejimCzFXD/kw4tXvTmXPugUv5uohL5fmp4onJ0MXc9nLhxFXD2VPoYcv5uohH0Z8engdZepgrh7iXjOLhNiILBJiI7JIiI3IIiE2IouE2IgsEmIjskiIjcgiITYii4TYiCwSYiOySIiNyCKh/wNgR1XAMFeLAQAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-11" style="display:block; margin: auto" />
<p class="caption">plot of chunk unnamed-chunk-11</p>
</div>
<h2 id="variable-selection">Variable selection</h2>
<p>We conclude with a simple example illustrating how <code>quantregGrowth</code> can be used to perform variable selection, namely when we are interested in spotting, typically few, important covariates among a large number of candidates. To illustrate, the simulated response below depends on the variables in the columns 3, 5, and 11 of the matrix <code>X</code> and on the linear covariate <code>z</code> which enters the model unpenalized</p>
<pre><code class="language-r">n &lt;- 50
z &lt;-1:n/n
p &lt;-20
set.seed(1515)
X&lt;-matrix(runif(n*p),n,p)
true.coef &lt;-rep(0,p)
true.coef[c(3,5,11)] &lt;- c(.7,1.5,-1)
y&lt;-5 + 1.5*z+  drop(X%*%true.coef) + rnorm(n)*.25
</code></pre>
<p>In order to discard noisy covariates we use the lasso penalty on corresponding coefficients. More specifically, the penalized objective to be minimized is \(\sum_i\rho_\tau (y_i-\beta_0-\beta_1z_i-\sum_j\gamma_jx_{ij})+\lambda \sum_j|\gamma_j|\), where \(\rho_\tau(\cdot)\) is the usual check function. Note the lasso penalty refers to the coefficients of the \(x_j\)’s only; \(\beta_0\) and \(\beta_1\) are unpenalized. The model is fitted straightforwardly by including the matrix <code>X</code> in <code>ps()</code>, and the unpenalized covariate in the main formula.</p>
<pre><code class="language-r">o &lt;-gcrq(y~ z + ps(X), tau=.5)
plot(o, term=1)
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-13" style="display:block; margin: auto" />
<p class="caption">plot of chunk unnamed-chunk-13</p>
</div>
The `plot` method returns the estimated coefficients relevant to the columns of `X`. 
<p>By means of the argument <code>ad</code> in <code>ps()</code> is possible to set an adaptive penalty via weights that are updated iteratively. <code>ad=1</code> leads to the adaptive lasso wherein the weights are given by the reciprocal of the coefficients at the previous iteration:</p>
<pre><code class="language-r">o1 &lt;-gcrq(y~ z + ps(X, ad=1), tau=.5) 
plot(o, term=1, ylim=c(-1.3,1.5)) #naive lasso, red circles
plot(o1, term=1, add=TRUE, col=3, pch=2) #adaptive lasso, green triangles 
points(true.coef, pch=3, col=4) #true coefficients, blue crosses
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-14" style="display:block; margin: auto" />
<p class="caption">plot of chunk unnamed-chunk-14</p>
</div>
<p>It is also possible to fit multiple quantile curves and to display the results accordingly</p>
<pre><code class="language-r">o &lt;-gcrq(y ~ z + ps(X))       #standard lasso
o1 &lt;-gcrq(y ~ z + ps(X, ad=1)) #adaptive lasso
par(mfrow=c(1,2))
plot(o, term=1, legend=TRUE)  #left panel: naive lasso 
plot(o1, term=1, legend=TRUE) #right panel: adaptive lasso
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-15" style="display:block; margin: auto" />
<p class="caption">plot of chunk unnamed-chunk-15</p>
</div>
<p>Note each symbol refers to a specific quantile curve, and results from the adaptive lasso (right plot) are closer to the true ones with noisy coefficients (all but those corresponding to columns 4 and 15) being substantially zero.</p>
<!--
output type provides a custom style sheet (and tweaks some options) to ensure that the resulting html is as small as possible. The `html_vignette` format:

- Never uses retina figures
- Has a smaller default figure size
- `summary`, `print`, `predict` 
-->
<h2 id="references">References</h2>
<ul>
<li>
<p>Muggeo V.M.R., Torretta F, Eilers P.H.C., Sciandra M., Attanasio M. (2021). Multiple smoothing parameters selection in additive regression quantiles, Statistical Modelling, 21, 428 - 448.
<a href="https://journals.sagepub.com/doi/full/10.1177/1471082X20929802">https://journals.sagepub.com/doi/full/10.1177/1471082X20929802</a></p>
</li>
<li>
<p>Muggeo V.M.R. (2021). Additive Quantile regression with automatic smoothness selection: the R package quantregGrowth. <a href="https://www.researchgate.net/publication/350844895_Additive_Quantile_regression_with_automatic_smoothness_selection_the_R_package_quantregGrowth">https://www.researchgate.net/publication/350844895_Additive_Quantile_regression_with_automatic_smoothness_selection_the_R_package_quantregGrowth</a></p>
</li>
</ul>
<hr />
<!--

#Attenzione.. al preambolo era questo..

date: "2024-05-20"
output: rmarkdown::html_vignette

#questo stava in fasiolo:
output: 
  html_document:
    toc: true

mia porposta:
output: 
  html_vignette:
    toc: true


IO ho cambiato output per il TOC.. .



## Methodological notes

You can write math expressions, e.g. 
$$
Q_Y(\tau|x,z)=\sum_j^Js_{j\tau}(x_j)+z^T\beta_\tau
$$
where $z^T\beta_\tau$ represents a linear predictor, and the term $s_{\tau}(\cdot)$ expresses the potentially nonlinear effect of covariate $X_j$ via  B-splines, i.e. $s_j(\cdot)=\sum_h^{H_j} b_{jh\tau}B_{jh}(\cdot)$ where $H_j$ is the fixed number of basis functions. The model is estimated by minimization of the penalized objective
$$
	\mathcal{L}_\lambda(b,\beta)=\sum_i \rho_\tau(y_i-B_i^Tb-z_i^T\beta) + \sum_j\lambda_j || D^d_j b_j ||_1
$$
where $B_i$ includes the basis function values for all smooth terms with corresponding coefficients $b=(b_1^T,\ldots,b^T_J)^T$ and the penalty $|| D^d_j b_j ||_1$ is the sum of absolute values of the coefficient differences (of order $d$): for instance to penalize the first-order differences ($d=1$) for the $j^{th}$ smooth term, 
$|| D^1_j b_j ||_1=\sum _h |\Delta^1 b^{(j)}_h|=\sum_h^{H_j-1}|b_{jh}-b_{j,h-1}|$. The penalty weight is tuned by the (positive) smoothing parameters $\lambda_j$s ($j=1,\ldots,J$): the larger the smoothing parameter, the smoother the fitted curve.



You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.


|                  |  mpg| cyl|  disp|  hp| drat|    wt|  qsec| vs| am| gear| carb|
|:-----------------|----:|---:|-----:|---:|----:|-----:|-----:|--:|--:|----:|----:|
|Mazda RX4         | 21.0|   6| 160.0| 110| 3.90| 2.620| 16.46|  0|  1|    4|    4|
|Mazda RX4 Wag     | 21.0|   6| 160.0| 110| 3.90| 2.875| 17.02|  0|  1|    4|    4|
|Datsun 710        | 22.8|   4| 108.0|  93| 3.85| 2.320| 18.61|  1|  1|    4|    1|
|Hornet 4 Drive    | 21.4|   6| 258.0| 110| 3.08| 3.215| 19.44|  1|  0|    3|    1|
|Hornet Sportabout | 18.7|   8| 360.0| 175| 3.15| 3.440| 17.02|  0|  0|    3|    2|
|Valiant           | 18.1|   6| 225.0| 105| 2.76| 3.460| 20.22|  1|  0|    3|    1|
|Duster 360        | 14.3|   8| 360.0| 245| 3.21| 3.570| 15.84|  0|  0|    3|    4|
|Merc 240D         | 24.4|   4| 146.7|  62| 3.69| 3.190| 20.00|  1|  0|    4|    2|
|Merc 230          | 22.8|   4| 140.8|  95| 3.92| 3.150| 22.90|  1|  0|    4|    2|
|Merc 280          | 19.2|   6| 167.6| 123| 3.92| 3.440| 18.30|  1|  0|    4|    4|

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
-->
</div>
<div class="include-after">
</div>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/combine/npm/katex/dist/katex.min.js,npm/katex/dist/contrib/auto-render.min.js,npm/@xiee/utils/js/render-katex.js" defer></script>
</body>
</html>
